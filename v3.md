<h1 align="center">
  <a href="https://github.com/romcal/romcal">
    <img alt="romcal" src="https://user-images.githubusercontent.com/1045997/89793747-854ede00-db26-11ea-8e46-837ab4ca0a96.png">
  </a>
</h1>

## Disclaimer

The content of this repository aim to be merged in the main **romcal** codebase.
Creating a separated repo helped me to architecture and rewrite the core codebase from a "white page".

## Getting Started

TBD

## What's new in v3

The core library of **romcal v3** has been almost completely rewritten (with existing features parity), and including new features from the romcal roadmap, and performance in mind.
The API and returned schema are 95% similar to the v2 (containing some improvements).

### A. Localization & Internationalization

- [x] [i18next](https://www.i18next.com/) has been integrated into the romcal library. This library provide all the i18n standard features, such as plurals, context, interpolation, format... to address all language specifics.
- [x] The content structure of the locale files has been reorganized a bit, to be closer to the GIRM & UNLY recommendations, and with modularity and scoping in mind (if someday, another Rite is supported by romcal).

### B. Builds

- [ ] I need to dive into Webpack, to make standalone and localized calendar build, with tender loving care ;) This mean that the core romcal library will only contain the general Roman calendar. All others localized calendars will be provided to romcal as standalone and lighten plugins. This will reduce the weight of the files (a front-end/browser concern), while optimizing a bit the computing time (especially on the i18n part).
- [ ] When building all the calendars, Webpack must complain or warn if locale keys are missing.
- [ ] We should consider providing CLI tooling to build custom owned calendar, list missing locale keys, ...
- [ ] We should provide examples on how using romcal with custom locales and calendars (e.g., for a parish calendar).
- [ ] Include [Babel.js](https://babeljs.io/) to ensure that romcal stay compatible on the latest browsers / Node.js versions.
- [ ] Plug build tools with GitHub Actions, to automatize builds, tests, versioning, releases...

### C. Metadata catalog

- [x] The first stone has been added for a Martyrology catalog. It's just a beginning... But actually it's already possible to wire the saint(s) (one or more) from the calendar definitions. The titles of the saint(s)/blessed are already wired between the calendar definitions and the Martyrology catalog (and it's used internally to determine the liturgical color: a martyr is red).
- [x] A new `martyrology` metadata is added on LiturgicalDay objects (when applies).
- [ ] In addition to the general data organization, we need to define better all the possible metadata, their types... and scope what is only about the Roman Rite.

### D. Performance

- [x] romcal v3 is 10x faster to run than the v2 (without the new i18n module), and have very limited JavaScript dependencies: Day.js and i18next only.
- [ ] The new i18n module (i18next) is costly in performance, but this can be partially fixed by including predefined locales per calendars.
- [x] The ranking implementation (precedence rules between liturgical days) has been completely rewritten. It now follows very closely the ยง 59 of the _Universal Norms on the Liturgical Year_ and the _General Roman Calendar_. A new meta property `precedence` has been added, the `rank` property has been simplified, and the `prioritized` property has been removed.
- [x] The calendar metadata of each `LiturgicalDay` objects has been simplified, containing less metadata (metadata that had performance impact has been removed, especially when they do not bring valuable information).
- [ ] The `Dates` library (coming from v1 & v2) must be refactored, to introduce caching and improve general computing performances.

### E. Calendar inheritance

- [x] The calendar inheritance is now built-in. I have added Europe and Americas has example: all Patrons of these 2 areas are defined in these 2 new calendars only.
- [x] It's also now possible to add diocesan calendars (file naming must be defined).
- [x] All calendar definition now inherit by default from an already existing definition, from a "parent" calendar. E.g., in a particular calendar, you just have to specify what to change (rank, date, titles, and even the name), if the liturgical day already exists in the General Roman calendar.
- [ ] We should consider adding an option to allow "global calendars", between the general and particular calendars. This will be useful for religious communities that have their proper general calendar (in addition to the GRC), but are also living in different places in the world (so they require to have both general & particular custom calendars).

### F. Codebase modularity

- [x] The main codebase has been reorganized to better identify and scope what only affect the Roman Rite, and what can be share between other rites or general features.

### G. Retrieve all possible liturgical days

- [ ] This feature is not ready yet, it requires a bit of refactor on some part of the code, especially the part that compute the Proper of the Time.
